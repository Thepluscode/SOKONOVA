{"version":3,"file":"cartService-DyySmEOA.js","sources":["../../src/lib/services/cartService.ts"],"sourcesContent":["// Cart Service - API integration for cart module\n\nimport api from '../api';\nimport type { Cart } from '../types';\n\n// Anonymous key for guest carts\nconst ANON_KEY_STORAGE = 'sokonova_anon_cart_key';\n\nfunction getAnonKey(): string {\n    let key = localStorage.getItem(ANON_KEY_STORAGE);\n    if (!key) {\n        key = `anon_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n        localStorage.setItem(ANON_KEY_STORAGE, key);\n    }\n    return key;\n}\n\nexport const cartService = {\n    /**\n     * Get or create cart for user\n     * GET /cart?userId=...&anonKey=...\n     */\n    get: async (userId?: string): Promise<Cart> => {\n        const params = userId\n            ? `userId=${userId}`\n            : `anonKey=${getAnonKey()}`;\n        return api.get<Cart>(`/cart?${params}`);\n    },\n\n    /**\n     * Add item to cart\n     * POST /cart/add\n     */\n    addItem: async (cartId: string, productId: string, qty: number = 1): Promise<Cart> => {\n        return api.post<Cart>('/cart/add', { cartId, productId, qty });\n    },\n\n    /**\n     * Remove item from cart\n     * DELETE /cart/remove?cartId=...&productId=...\n     */\n    removeItem: async (cartId: string, productId: string): Promise<Cart> => {\n        return api.delete<Cart>(`/cart/remove?cartId=${cartId}&productId=${productId}`);\n    },\n\n    /**\n     * Clear entire cart\n     * DELETE /cart/clear?cartId=...\n     */\n    clear: async (cartId: string): Promise<Cart> => {\n        return api.delete<Cart>(`/cart/clear?cartId=${cartId}`);\n    },\n\n    /**\n     * Update item quantity (convenience method)\n     * Removes item if qty is 0, otherwise adds/updates\n     */\n    updateQuantity: async (cartId: string, productId: string, qty: number): Promise<Cart> => {\n        if (qty <= 0) {\n            return cartService.removeItem(cartId, productId);\n        }\n        return cartService.addItem(cartId, productId, qty);\n    },\n};\n\nexport default cartService;\n"],"names":["ANON_KEY_STORAGE","getAnonKey","key","cartService","userId","params","api","cartId","productId","qty"],"mappings":"wCAMA,MAAMA,EAAmB,yBAEzB,SAASC,GAAqB,CAC1B,IAAIC,EAAM,aAAa,QAAQF,CAAgB,EAC/C,OAAKE,IACDA,EAAM,QAAQ,KAAK,IAAA,CAAK,IAAI,KAAK,OAAA,EAAS,SAAS,EAAE,EAAE,OAAO,EAAG,CAAC,CAAC,GACnE,aAAa,QAAQF,EAAkBE,CAAG,GAEvCA,CACX,CAEO,MAAMC,EAAc,CAKvB,IAAK,MAAOC,GAAmC,CAC3C,MAAMC,EAASD,EACT,UAAUA,CAAM,GAChB,WAAWH,GAAY,GAC7B,OAAOK,EAAI,IAAU,SAASD,CAAM,EAAE,CAC1C,EAMA,QAAS,MAAOE,EAAgBC,EAAmBC,EAAc,IACtDH,EAAI,KAAW,YAAa,CAAE,OAAAC,EAAQ,UAAAC,EAAW,IAAAC,EAAK,EAOjE,WAAY,MAAOF,EAAgBC,IACxBF,EAAI,OAAa,uBAAuBC,CAAM,cAAcC,CAAS,EAAE,EAOlF,MAAO,MAAOD,GACHD,EAAI,OAAa,sBAAsBC,CAAM,EAAE,EAO1D,eAAgB,MAAOA,EAAgBC,EAAmBC,IAClDA,GAAO,EACAN,EAAY,WAAWI,EAAQC,CAAS,EAE5CL,EAAY,QAAQI,EAAQC,EAAWC,CAAG,CAEzD"}
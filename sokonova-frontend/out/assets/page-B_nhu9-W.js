import{d as J,i as _,r as a,j as e,L as z}from"./index-BuEVh5sI.js";import{H as C,F as R}from"./Footer-BUHV-7DN.js";import{B as Q}from"./Button-CIhQbQx6.js";import{S as $}from"./SkeletonLoader-xTJJaupH.js";import{p as W}from"./productsService-CjVt01BF.js";import{a as g}from"./analyticsService-DRYpkHFo.js";function ae(){const{user:n}=J();_("SELLER");const[h,A]=a.useState("30d"),[u,I]=a.useState("revenue"),[o,P]=a.useState(!1),[M,T]=a.useState(new Date),[U,S]=a.useState(!0),[D,L]=a.useState(null),[l,E]=a.useState({revenue:{current:0,previous:0,change:0,chartData:[]},orders:{current:0,previous:0,change:0,chartData:[]},visitors:{current:0,previous:0,change:0,chartData:[]},conversion:{current:0,previous:0,change:0,chartData:[]}}),[v,O]=a.useState([]),[b,F]=a.useState({topCountries:[],ageGroups:[]}),[d,G]=a.useState({riskAnalysis:null,stockoutPredictions:[],velocityMetrics:[]});a.useEffect(()=>{async function t(){if(n?.id){S(!0),L(null);try{const[s,c,i,j,q,B]=await Promise.all([g.getSellerProfitability(n.id).catch(()=>null),g.getBuyerInsights(n.id).catch(()=>null),W.list({sellerId:n.id}).catch(()=>[]),g.getInventoryRiskAnalysis(n.id).catch(()=>null),g.getStockoutPredictions(n.id).catch(()=>[]),g.getInventoryVelocity(n.id).catch(()=>[])]);G({riskAnalysis:j,stockoutPredictions:q,velocityMetrics:B});const k=s?.totalRevenue||0,y=s?.totalOrders||0,m=s?.totalVisitors||1e3,f=m>0?y/m*100:0,p=(r,N=7)=>Array.from({length:N},(X,H)=>{const w=new Date;w.setDate(w.getDate()-(N-1-H));const K=(Math.random()-.5)*.4;return{date:w.toISOString().split("T")[0],value:Math.round(r/N*(1+K))}});E({revenue:{current:k,previous:k*.85,change:17.6,chartData:p(k)},orders:{current:y,previous:Math.floor(y*.88),change:13.6,chartData:p(y)},visitors:{current:m,previous:Math.floor(m*.82),change:22,chartData:p(m)},conversion:{current:f,previous:f*.95,change:5.3,chartData:p(f*100,7).map(r=>({...r,value:r.value/10}))}}),O(i.slice(0,5).map(r=>({id:r.id,name:r.title,revenue:Number(r.price)*(r.soldCount||0),orders:r.soldCount||0,views:r.viewCount||Math.floor(Math.random()*500)+100,conversion:((r.soldCount||0)/(r.viewCount||1)*100).toFixed(1),image:r.imageUrl||`https://readdy.ai/api/search-image?query=product&width=300&height=300&seq=${r.id}&orientation=squarish`}))),F({topCountries:c?.topCountries||[{country:"United States",orders:45,revenue:5400},{country:"United Kingdom",orders:32,revenue:3800},{country:"Nigeria",orders:28,revenue:3200},{country:"Ghana",orders:22,revenue:2600},{country:"Kenya",orders:18,revenue:2100}],ageGroups:c?.ageGroups||[{group:"25-34",percentage:35},{group:"35-44",percentage:28},{group:"45-54",percentage:22},{group:"18-24",percentage:10},{group:"55+",percentage:5}]})}catch(s){console.error("Failed to fetch analytics:",s),L("Could not load analytics. Please try again.")}finally{S(!1)}}}t()},[n?.id,h]),a.useEffect(()=>{if(o){const t=setInterval(()=>{T(new Date)},5e3);return()=>clearInterval(t)}},[o]);const x=l[u],V=()=>{const t={timeRange:h,metrics:l,topProducts:v,customerInsights:b,exportedAt:new Date().toISOString()},s=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),c=URL.createObjectURL(s),i=document.createElement("a");i.href=c,i.download=`analytics-report-${h}-${Date.now()}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(c)};return U?e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx(C,{}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[1,2,3,4].map(t=>e.jsx($,{type:"card"},t))}),e.jsx($,{type:"card"})]}),e.jsx(R,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors",children:[e.jsx(C,{}),e.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 transition-colors",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(z,{to:"/seller-dashboard",className:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",children:e.jsx("i",{className:"ri-arrow-left-line text-xl"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Analytics & Performance"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Track your store performance and customer insights"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:()=>P(!o),className:`flex items-center space-x-2 px-4 py-2 rounded-lg border transition-all cursor-pointer ${o?"bg-emerald-50 dark:bg-emerald-900/20 border-emerald-500 text-emerald-600 dark:text-emerald-400":"border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${o?"bg-emerald-500 animate-pulse":"bg-gray-400"}`}),e.jsx("span",{className:"text-sm font-medium",children:"Real-time"})]}),e.jsxs("select",{value:h,onChange:t=>A(t.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 dark:bg-gray-700 dark:text-white transition-colors",children:[e.jsx("option",{value:"7d",children:"Last 7 days"}),e.jsx("option",{value:"30d",children:"Last 30 days"}),e.jsx("option",{value:"90d",children:"Last 90 days"}),e.jsx("option",{value:"1y",children:"Last year"})]}),e.jsxs(Q,{variant:"outline",onClick:V,children:[e.jsx("i",{className:"ri-download-line mr-2"}),"Export Report"]})]})]}),o&&e.jsxs("div",{className:"mt-4 flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("i",{className:"ri-time-line"}),e.jsxs("span",{children:["Last updated: ",M.toLocaleTimeString()]})]})]})}),D&&e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-8",children:e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-800",children:D})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[{key:"revenue",label:"Total Revenue",value:`$${l.revenue.current.toLocaleString()}`,icon:"ri-money-dollar-circle-line",color:"emerald"},{key:"orders",label:"Total Orders",value:l.orders.current.toString(),icon:"ri-shopping-bag-line",color:"blue"},{key:"visitors",label:"Store Visitors",value:l.visitors.current.toLocaleString(),icon:"ri-eye-line",color:"purple"},{key:"conversion",label:"Conversion Rate",value:`${l.conversion.current.toFixed(1)}%`,icon:"ri-line-chart-line",color:"orange"}].map(t=>e.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm cursor-pointer border-2 transition-all hover:shadow-md ${u===t.key?"border-emerald-500 scale-105":"border-transparent"}`,onClick:()=>I(t.key),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:t.label}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t.value})]}),e.jsx("div",{className:`w-12 h-12 bg-${t.color}-100 dark:bg-${t.color}-900/30 text-${t.color}-600 dark:text-${t.color}-400 rounded-lg flex items-center justify-center`,children:e.jsx("i",{className:`${t.icon} text-xl`})})]}),e.jsxs("div",{className:"mt-4 flex items-center text-sm",children:[e.jsxs("span",{className:`font-medium ${l[t.key].change>=0?"text-green-600":"text-red-600"}`,children:[l[t.key].change>=0?"+":"",l[t.key].change.toFixed(1),"%"]}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400 ml-2",children:"vs previous period"})]})]},t.key))}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 mb-8 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[u.charAt(0).toUpperCase()+u.slice(1)," Trend"]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("span",{className:`font-medium ${x.change>=0?"text-green-600":"text-red-600"}`,children:[x.change>=0?"+":"",x.change.toFixed(1),"%"]}),e.jsx("span",{children:"change"})]})]}),e.jsx("div",{className:"h-64 flex items-end space-x-2",children:x.chartData.map((t,s)=>{const c=Math.max(...x.chartData.map(j=>j.value)),i=c>0?t.value/c*200:20;return e.jsxs("div",{className:"flex-1 flex flex-col items-center group",children:[e.jsx("div",{className:"relative w-full",children:e.jsx("div",{className:"w-full bg-gradient-to-t from-emerald-500 to-emerald-400 rounded-t-lg transition-all duration-300 group-hover:from-emerald-600 group-hover:to-emerald-500 cursor-pointer",style:{height:`${Math.max(i,10)}px`},children:e.jsx("div",{className:"absolute -top-8 left-1/2 -translate-x-1/2 bg-gray-900 dark:bg-gray-700 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:typeof t.value=="number"?t.value.toLocaleString():t.value})})}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:new Date(t.date).getDate()})]},s)})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm transition-colors",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Top Performing Products"})}),e.jsx("div",{className:"p-6",children:v.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No products yet."}):e.jsx("div",{className:"space-y-4",children:v.map((t,s)=>e.jsxs("div",{className:"flex items-center space-x-4 p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[e.jsx("span",{className:"w-6 h-6 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded-full flex items-center justify-center text-sm font-medium",children:s+1}),e.jsx("img",{src:t.image,alt:t.name,className:"w-12 h-12 rounded-lg object-cover"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white truncate",children:t.name}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("span",{children:["$",t.revenue.toLocaleString()]}),e.jsxs("span",{children:[t.orders," orders"]}),e.jsxs("span",{children:[t.conversion,"% conv."]})]})]})]},t.id))})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm transition-colors",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Customer Insights"})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-3",children:"Top Countries"}),e.jsx("div",{className:"space-y-2",children:b.topCountries.map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.country}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.orders}),e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["$",t.revenue]})]})]},s))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-3",children:"Age Groups"}),e.jsx("div",{className:"space-y-2",children:b.ageGroups.map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.group}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-20 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-2 bg-emerald-500 rounded-full transition-all duration-500",style:{width:`${t.percentage}%`}})}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white w-10 text-right",children:[t.percentage,"%"]})]})]},s))})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mt-8",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx("i",{className:"ri-alert-line mr-2 text-amber-500"}),"Inventory Risk"]}),d.riskAnalysis?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[e.jsx("span",{className:"text-red-700 dark:text-red-400",children:"Low Stock"}),e.jsx("span",{className:"font-bold text-red-700 dark:text-red-400",children:d.riskAnalysis.lowStock||0})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-amber-50 dark:bg-amber-900/20 rounded-lg",children:[e.jsx("span",{className:"text-amber-700 dark:text-amber-400",children:"Overstock"}),e.jsx("span",{className:"font-bold text-amber-700 dark:text-amber-400",children:d.riskAnalysis.overstock||0})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-emerald-50 dark:bg-emerald-900/20 rounded-lg",children:[e.jsx("span",{className:"text-emerald-700 dark:text-emerald-400",children:"Healthy"}),e.jsx("span",{className:"font-bold text-emerald-700 dark:text-emerald-400",children:d.riskAnalysis.healthy||0})]})]}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No risk data available"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx("i",{className:"ri-timer-line mr-2 text-red-500"}),"Stockout Predictions"]}),d.stockoutPredictions.length>0?e.jsx("div",{className:"space-y-2",children:d.stockoutPredictions.slice(0,5).map((t,s)=>e.jsxs("div",{className:"flex justify-between items-center p-2 hover:bg-gray-50 dark:hover:bg-gray-700 rounded",children:[e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300 truncate max-w-[60%]",children:t.title||t.productTitle}),e.jsxs("span",{className:"text-xs font-medium px-2 py-1 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 rounded",children:[t.daysUntilStockout||t.daysLeft||"?"," days"]})]},s))}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No stockout risks"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx("i",{className:"ri-speed-line mr-2 text-blue-500"}),"Inventory Velocity"]}),d.velocityMetrics.length>0?e.jsx("div",{className:"space-y-2",children:d.velocityMetrics.slice(0,5).map((t,s)=>e.jsxs("div",{className:"flex justify-between items-center p-2 hover:bg-gray-50 dark:hover:bg-gray-700 rounded",children:[e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300 truncate max-w-[60%]",children:t.title}),e.jsx("span",{className:`text-xs font-medium px-2 py-1 rounded ${t.velocity==="fast"?"bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400":t.velocity==="medium"?"bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:t.velocity||"slow"})]},s))}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No velocity data"})]})]})]}),e.jsx(R,{})]})}export{ae as default};
//# sourceMappingURL=page-B_nhu9-W.js.map

import{r as c,j as e,a as k,L as f}from"./index-ZA5ZORNU.js";import{H as D,F as I}from"./Footer-BVlzreGV.js";import{B as o}from"./Button-CvyvXJgt.js";import{p as O}from"./productsService-Botvl8AH.js";import{o as C}from"./ordersService-Blzx0c5_.js";const F=({orderId:m,items:n,onReorder:h})=>{const[y,d]=c.useState(!1),[N,x]=c.useState(!1),a=()=>{d(!0),setTimeout(()=>{n.forEach(r=>{const p=JSON.parse(localStorage.getItem("cart")||"[]"),u=p.find(g=>g.id===r.id);u?u.quantity+=r.quantity:p.push({id:r.id,name:r.name,price:r.price,quantity:r.quantity,image:r.image}),localStorage.setItem("cart",JSON.stringify(p))}),d(!1),x(!0),window.dispatchEvent(new Event("cartUpdated")),h&&h(),setTimeout(()=>{x(!1)},3e3)},1e3)};return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:a,disabled:y,className:"inline-flex items-center gap-2 px-4 py-2 bg-teal-600 text-white text-sm font-medium rounded-lg hover:bg-teal-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap cursor-pointer",children:y?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin"}),"Adding to Cart..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-shopping-cart-line"}),"Reorder"]})}),N&&e.jsx("div",{className:"fixed bottom-6 right-6 bg-emerald-600 text-white px-6 py-4 rounded-xl shadow-lg z-50 animate-slide-up",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("i",{className:"ri-checkbox-circle-fill text-2xl"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Items added to cart!"}),e.jsxs("p",{className:"text-sm text-emerald-100",children:[n.length," items from order #",m]})]})]})})]})};function L(){const{user:m}=k(),[n,h]=c.useState("all"),[y,d]=c.useState(!0),[N,x]=c.useState(null),[a,r]=c.useState([]);c.useEffect(()=>{async function s(){if(!m?.id){d(!1);return}d(!0),x(null);try{const t=await C.listForUser(m.id),w=await Promise.all(t.map(async i=>{const b=i.items?.map(l=>l.productId)||[];let v=[];try{b.length>0&&(v=await O.getByIds(b))}catch{}return{id:i.id,date:i.createdAt,status:i.status?.toLowerCase()||"processing",total:Number(i.total),tracking:i.trackingNumber,deliveryDate:i.deliveredAt,estimatedDelivery:i.estimatedDelivery,items:(i.items||[]).map(l=>{const j=v.find(S=>S.id===l.productId);return{id:l.productId,name:j?.title||"Product",price:Number(l.unitPrice||j?.price||0),quantity:l.qty,seller:j?.user?.storeName||"Seller",image:j?.imageUrl||`https://readdy.ai/api/search-image?query=product&width=100&height=125&seq=${l.productId}&orientation=portrait`}})}}));r(w)}catch(t){console.error("Failed to fetch orders:",t),x("Failed to load orders. Please try again.")}finally{d(!1)}}s()},[m?.id]);const p=s=>{switch(s){case"delivered":return"bg-green-100 text-green-700";case"shipped":return"bg-blue-100 text-blue-700";case"processing":return"bg-yellow-100 text-yellow-700";case"cancelled":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},u=s=>{switch(s){case"delivered":return"ri-checkbox-circle-fill";case"shipped":return"ri-truck-line";case"processing":return"ri-time-line";case"cancelled":return"ri-close-circle-fill";default:return"ri-information-line"}},g=n==="all"?a:a.filter(s=>s.status===n);return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(D,{}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"My Orders"}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 mb-6",children:e.jsx("div",{className:"flex overflow-x-auto",children:[{id:"all",label:"All Orders",count:a.length},{id:"processing",label:"Processing",count:a.filter(s=>s.status==="processing").length},{id:"shipped",label:"Shipped",count:a.filter(s=>s.status==="shipped").length},{id:"delivered",label:"Delivered",count:a.filter(s=>s.status==="delivered").length},{id:"cancelled",label:"Cancelled",count:a.filter(s=>s.status==="cancelled").length}].map(s=>e.jsxs("button",{onClick:()=>h(s.id),className:`flex-1 px-6 py-4 text-sm font-medium whitespace-nowrap cursor-pointer ${n===s.id?"border-b-2 border-emerald-600 text-emerald-600":"text-gray-600 hover:text-gray-900"}`,children:[s.label," (",s.count,")"]},s.id))})}),e.jsx("div",{className:"space-y-6",children:g.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-shopping-bag-line text-4xl text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No orders found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"You haven't placed any orders yet"}),e.jsx(f,{to:"/products",children:e.jsxs(o,{className:"whitespace-nowrap",children:[e.jsx("i",{className:"ri-shopping-cart-line mr-2"}),"Start Shopping"]})})]}):g.map(s=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Order ID"}),e.jsx("p",{className:"font-semibold text-gray-900",children:s.id})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Date"}),e.jsx("p",{className:"font-semibold text-gray-900",children:new Date(s.date).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total"}),e.jsxs("p",{className:"font-semibold text-gray-900",children:["$",s.total.toFixed(2)]})]})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium whitespace-nowrap ${p(s.status)}`,children:[e.jsx("i",{className:`${u(s.status)} mr-1`}),s.status.charAt(0).toUpperCase()+s.status.slice(1)]})})]})}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"space-y-4",children:s.items.map(t=>e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx(f,{to:`/products/${t.id}`,className:"flex-shrink-0 cursor-pointer",children:e.jsx("img",{src:t.image,alt:t.name,className:"w-20 h-25 object-cover object-top rounded-lg"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(f,{to:`/products/${t.id}`,className:"cursor-pointer",children:e.jsx("h3",{className:"text-base font-semibold text-gray-900 hover:text-emerald-600",children:t.name})}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[e.jsx("i",{className:"ri-store-2-line mr-1"}),t.seller]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Qty: ",t.quantity]}),e.jsxs("span",{className:"text-base font-bold text-gray-900",children:["$",t.price]})]})]})]},t.id))}),s.tracking&&e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Tracking Number"}),e.jsx("p",{className:"font-mono font-semibold text-gray-900",children:s.tracking}),s.estimatedDelivery&&e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["Estimated delivery: ",new Date(s.estimatedDelivery).toLocaleDateString()]}),s.deliveryDate&&e.jsxs("p",{className:"text-sm text-green-600 mt-2",children:[e.jsx("i",{className:"ri-checkbox-circle-fill mr-1"}),"Delivered on ",new Date(s.deliveryDate).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(f,{to:`/orders/${s.id}/tracking`,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors text-center whitespace-nowrap",children:"Track Order"}),e.jsx(F,{orderId:s.id,items:s.items})]})]})}),s.cancelReason&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Cancellation reason:"}),e.jsx("p",{className:"text-gray-900",children:s.cancelReason})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200 flex items-center justify-end space-x-3",children:[s.status==="delivered"&&e.jsxs(e.Fragment,{children:[e.jsxs(o,{variant:"outline",className:"whitespace-nowrap",children:[e.jsx("i",{className:"ri-star-line mr-2"}),"Write Review"]}),e.jsxs(o,{variant:"outline",className:"whitespace-nowrap",children:[e.jsx("i",{className:"ri-arrow-go-back-line mr-2"}),"Return Item"]})]}),s.status==="processing"&&e.jsxs(o,{variant:"outline",className:"whitespace-nowrap",children:[e.jsx("i",{className:"ri-close-line mr-2"}),"Cancel Order"]}),e.jsxs(o,{variant:"outline",className:"whitespace-nowrap",children:[e.jsx("i",{className:"ri-file-text-line mr-2"}),"View Invoice"]}),e.jsxs(o,{className:"whitespace-nowrap",children:[e.jsx("i",{className:"ri-message-3-line mr-2"}),"Contact Seller"]})]})]})]},s.id))})]}),e.jsx(I,{})]})}export{L as default};
//# sourceMappingURL=page-77Fzv9Qz.js.map

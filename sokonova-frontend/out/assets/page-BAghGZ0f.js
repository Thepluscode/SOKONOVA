import{d as l,i as k,a as C,r as c,j as t,L as A}from"./index-ZA5ZORNU.js";import{H as u,F as f}from"./Footer-BVlzreGV.js";import{S as $}from"./SkeletonLoader-D9m7szI5.js";const d={list:async(a,i)=>{const m={userId:a,limit:i?.limit,unreadOnly:i?.unreadOnly},r=k(m);return l.get(`/notifications${r}`)},getUnreadCount:async a=>l.get(`/notifications/unread-count?userId=${a}`),markRead:async(a,i)=>l.post(`/notifications/${a}/read`,{userId:i}),markAllRead:async a=>l.post("/notifications/mark-all-read",{userId:a}),delete:async(a,i)=>l.post(`/notifications/${a}/delete`,{userId:i})};function R(){const{user:a}=C(),[i,m]=c.useState("all"),[r,n]=c.useState([]),[p,x]=c.useState(!0);c.useEffect(()=>{async function e(){if(!a?.id){x(!1);return}x(!0);try{const s=await d.list(a.id);n(s.map(o=>({id:o.id,type:o.channel?.toLowerCase()||"system",title:o.title||"Notification",message:o.body||o.message||"",time:y(o.createdAt),read:o.readAt!==null,icon:g(o.channel),iconColor:N(o.channel)})))}catch(s){console.error("Failed to fetch notifications:",s)}finally{x(!1)}}e()},[a?.id]);function y(e){const s=Math.floor((Date.now()-new Date(e).getTime())/1e3);return s<60?"Just now":s<3600?`${Math.floor(s/60)} minutes ago`:s<86400?`${Math.floor(s/3600)} hours ago`:`${Math.floor(s/86400)} days ago`}function g(e){switch(e?.toLowerCase()){case"orders":return"ri-truck-line";case"promotions":return"ri-fire-line";case"system":return"ri-shield-check-line";default:return"ri-notification-line"}}function N(e){switch(e?.toLowerCase()){case"orders":return"text-emerald-600";case"promotions":return"text-orange-600";case"system":return"text-blue-600";default:return"text-gray-600"}}const j={all:r.length,orders:r.filter(e=>e.type==="orders").length,promotions:r.filter(e=>e.type==="promotions").length,system:r.filter(e=>e.type==="system").length},h=i==="all"?r:r.filter(e=>e.type===i),w=async e=>{try{await d.markRead(e,a?.id||""),n(r.map(s=>s.id===e?{...s,read:!0}:s))}catch(s){console.error("Failed to mark as read:",s)}},b=async()=>{if(a?.id)try{await d.markAllRead(a.id),n(r.map(e=>({...e,read:!0})))}catch(e){console.error("Failed to mark all as read:",e)}},v=async e=>{try{await d.delete(e,a?.id||""),n(r.filter(s=>s.id!==e))}catch(s){console.error("Failed to delete notification:",s)}};return p?t.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[t.jsx(u,{}),t.jsxs("div",{className:"flex-1 max-w-4xl mx-auto w-full px-4 py-8",children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Notifications"}),t.jsx("div",{className:"space-y-3",children:[...Array(5)].map((e,s)=>t.jsx($,{type:"text"},s))})]}),t.jsx(f,{})]}):t.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[t.jsx(u,{}),t.jsxs("div",{className:"flex-1 max-w-4xl mx-auto w-full px-4 py-8",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Notifications"}),t.jsx("button",{onClick:b,className:"text-sm text-emerald-600 hover:text-emerald-700 font-medium whitespace-nowrap",children:"Mark all as read"})]}),t.jsx("p",{className:"text-gray-600",children:"Stay updated with your orders and promotions"})]}),t.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 mb-6",children:t.jsx("div",{className:"flex flex-wrap gap-3",children:["all","orders","promotions","system"].map(e=>t.jsxs("button",{onClick:()=>m(e),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors whitespace-nowrap ${i===e?"bg-emerald-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.charAt(0).toUpperCase()+e.slice(1)," (",j[e],")"]},e))})}),t.jsx("div",{className:"space-y-3",children:h.length===0?t.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-12 text-center",children:[t.jsx("i",{className:"ri-notification-off-line text-6xl text-gray-300 mb-4"}),t.jsx("p",{className:"text-gray-500",children:"No notifications in this category"})]}):h.map(e=>t.jsx("div",{className:`bg-white rounded-xl shadow-sm p-4 transition-all hover:shadow-md ${e.read?"":"border-l-4 border-emerald-600"}`,children:t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center flex-shrink-0",children:t.jsx("i",{className:`${e.icon} text-xl ${e.iconColor}`})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-start justify-between gap-4 mb-1",children:[t.jsx("h3",{className:"font-semibold text-gray-900",children:e.title}),t.jsx("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:e.time})]}),t.jsx("p",{className:"text-sm text-gray-600 mb-3",children:e.message}),t.jsxs("div",{className:"flex items-center gap-4",children:[!e.read&&t.jsx("button",{onClick:()=>w(e.id),className:"text-xs text-emerald-600 hover:text-emerald-700 font-medium whitespace-nowrap",children:"Mark as read"}),t.jsx("button",{onClick:()=>v(e.id),className:"text-xs text-red-600 hover:text-red-700 font-medium whitespace-nowrap",children:"Delete"})]})]})]})},e.id))}),t.jsx("div",{className:"mt-8 text-center",children:t.jsxs(A,{to:"/account/settings/notifications",className:"inline-flex items-center gap-2 text-emerald-600 hover:text-emerald-700 font-medium",children:[t.jsx("i",{className:"ri-settings-3-line"}),"Notification Settings"]})})]}),t.jsx(f,{})]})}export{R as default};
//# sourceMappingURL=page-BAghGZ0f.js.map

import{i as H,r as a,j as e}from"./index-BuEVh5sI.js";import{H as O,F as U}from"./Footer-BUHV-7DN.js";import{B as j}from"./Button-CIhQbQx6.js";import{a as x}from"./adminService-DcdpesXo.js";function q(){H("ADMIN");const[i,h]=a.useState("overview"),[N,v]=a.useState(!0),[g,y]=a.useState(!1),[n,w]=a.useState(null),[k,S]=a.useState(null),[I,A]=a.useState(null),[M,$]=a.useState(null),[C,D]=a.useState([]),[T,L]=a.useState([]),[d,R]=a.useState([]),[b,P]=a.useState([]),f=async()=>{try{const[s,t,l,u]=await Promise.all([x.getControlTowerHealth().catch(()=>null),x.getControlTowerMetrics().catch(()=>null),x.getControlTowerAlerts().catch(()=>null),x.getControlTowerUserInsights().catch(()=>null)]);if(w(s),S(t),A(l),$(u),s&&(D([{name:"API Uptime",value:"99.98%",status:s.healthStatus||"healthy",icon:"ri-server-line"},{name:"Database",value:s.healthStatus==="HEALTHY"?"Optimal":s.healthStatus,status:"healthy",icon:"ri-database-2-line"},{name:"Total Users",value:s.userCount?.toLocaleString()||"0",status:"healthy",icon:"ri-user-line"},{name:"Total Products",value:s.productCount?.toLocaleString()||"0",status:"healthy",icon:"ri-shopping-bag-line"}]),L([{label:"Total Users",value:s.userCount?.toLocaleString()||"0",change:`+${s.userGrowth||0}`,icon:"ri-user-line"},{label:"Total Orders",value:s.orderCount?.toLocaleString()||"0",change:"+"+s.recentOrdersCount,icon:"ri-shopping-cart-line"},{label:"Active Sellers",value:s.sellerCount?.toLocaleString()||"0",change:"+0%",icon:"ri-store-2-line"},{label:"Pending Applications",value:s.pendingApplications?.toString()||"0",change:"",icon:"ri-time-line"}])),l){const c=[];l.pendingApplications?.length>0&&l.pendingApplications.forEach((r,o)=>{c.push({id:`app-${o}`,type:"warning",message:`Pending seller application from ${r.user?.name||"Unknown"}`,time:"Pending review",severity:"medium"})}),l.openDisputes?.length>0&&l.openDisputes.forEach((r,o)=>{c.push({id:`dispute-${o}`,type:"error",message:`Open dispute: ${r.orderItem?.product?.title||"Order item"}`,time:"Action required",severity:"high"})}),l.complianceIssues?.length>0&&l.complianceIssues.forEach((r,o)=>{c.push({id:`compliance-${o}`,type:"warning",message:`KYC rejected for ${r.seller?.shopName||"Seller"}`,time:"Review needed",severity:"medium"})}),R(c)}if(u?.userByCountry){const c=u.userByCountry.slice(0,5).map(r=>({region:r.country||"Unknown",orders:r._count||0,revenue:"$"+((r._count||0)*50).toLocaleString(),growth:"+"+Math.floor(Math.random()*20)+"%",status:r._count>100?"excellent":"good"}));P(c)}}catch(s){console.error("Failed to fetch control tower data:",s)}finally{v(!1),y(!1)}};a.useEffect(()=>{f()},[]);const E=()=>{y(!0),f()},p=n?.healthStatus||"STABLE",m=p==="HEALTHY"||p==="STABLE";return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(O,{}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-8 animate-fade-in-down",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Control Tower"}),e.jsx("p",{className:"text-gray-600",children:"Real-time platform monitoring and operations"})]}),e.jsxs("div",{className:"flex items-center space-x-3 mt-4 sm:mt-0",children:[e.jsxs("div",{className:`flex items-center space-x-2 px-4 py-2 ${m?"bg-green-50 border-green-200":"bg-yellow-50 border-yellow-200"} border rounded-lg`,children:[e.jsx("div",{className:`w-2 h-2 ${m?"bg-green-600":"bg-yellow-600"} rounded-full animate-pulse`}),e.jsx("span",{className:`text-sm font-medium ${m?"text-green-700":"text-yellow-700"}`,children:m?"All Systems Operational":p})]}),e.jsxs(j,{onClick:E,disabled:g,className:"whitespace-nowrap",children:[e.jsx("i",{className:`ri-refresh-line mr-2 ${g?"animate-spin":""}`}),g?"Refreshing...":"Refresh"]})]})]}),N?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[1,2,3,4].map(s=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 animate-pulse",children:[e.jsx("div",{className:"h-12 w-12 bg-gray-200 rounded-lg mb-4"}),e.jsx("div",{className:"h-4 w-24 bg-gray-200 rounded mb-2"}),e.jsx("div",{className:"h-6 w-16 bg-gray-200 rounded"})]},s))}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:C.map((s,t)=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 animate-fade-in-up",style:{animationDelay:`${t*100}ms`},children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:`${s.icon} text-2xl text-green-600`})}),e.jsx("span",{className:"w-3 h-3 bg-green-600 rounded-full animate-pulse"})]}),e.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-1",children:s.name}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:s.value})]},t))}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 mb-6 animate-scale-in",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("div",{className:"flex space-x-8 px-6",children:[e.jsx("button",{onClick:()=>h("overview"),className:`py-4 border-b-2 font-medium text-sm transition-colors cursor-pointer ${i==="overview"?"border-emerald-600 text-emerald-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Overview"}),e.jsxs("button",{onClick:()=>h("alerts"),className:`py-4 border-b-2 font-medium text-sm transition-colors cursor-pointer ${i==="alerts"?"border-emerald-600 text-emerald-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Alerts",d.length>0&&e.jsx("span",{className:"ml-2 px-2 py-1 bg-red-100 text-red-700 text-xs font-semibold rounded-full",children:d.length})]}),e.jsx("button",{onClick:()=>h("performance"),className:`py-4 border-b-2 font-medium text-sm transition-colors cursor-pointer ${i==="performance"?"border-emerald-600 text-emerald-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Performance"})]})}),e.jsxs("div",{className:"p-6",children:[i==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Live Metrics"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:T.map((s,t)=>e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200 animate-fade-in-up",style:{animationDelay:`${t*50}ms`},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("i",{className:`${s.icon} text-xl text-gray-600`}),s.change&&e.jsx("span",{className:"text-xs font-medium text-green-600",children:s.change})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mb-1",children:s.value}),e.jsx("p",{className:"text-sm text-gray-600",children:s.label})]},t))})]}),b.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"User Distribution by Region"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Region"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Users"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Est. Revenue"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Growth"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:b.map((s,t)=>e.jsxs("tr",{className:"hover:bg-gray-50 animate-fade-in-up",style:{animationDelay:`${t*50}ms`},children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-medium text-gray-900",children:s.region}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-700",children:s.orders}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-700",children:s.revenue}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-green-600 font-medium",children:s.growth})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${s.status==="excellent"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:s.status})})]},t))})]})})]})]}),i==="alerts"&&e.jsx("div",{className:"space-y-4",children:d.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"ri-checkbox-circle-line text-5xl text-green-500 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"No Active Alerts"}),e.jsx("p",{className:"text-gray-600",children:"All systems are operating normally."})]}):d.map((s,t)=>e.jsx("div",{className:`p-4 rounded-lg border hover-lift animate-fade-in-up ${s.type==="error"?"bg-red-50 border-red-200":s.type==="warning"?"bg-yellow-50 border-yellow-200":s.type==="success"?"bg-green-50 border-green-200":"bg-blue-50 border-blue-200"}`,style:{animationDelay:`${t*100}ms`},children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("i",{className:`text-xl ${s.type==="error"?"ri-error-warning-line text-red-600":s.type==="warning"?"ri-alert-line text-yellow-600":s.type==="success"?"ri-checkbox-circle-line text-green-600":"ri-information-line text-blue-600"}`}),e.jsxs("div",{children:[e.jsx("p",{className:`font-medium ${s.type==="error"?"text-red-900":s.type==="warning"?"text-yellow-900":s.type==="success"?"text-green-900":"text-blue-900"}`,children:s.message}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.time})]})]}),e.jsx(j,{variant:"outline",size:"sm",className:"whitespace-nowrap",children:"Resolve"})]})},s.id))}),i==="performance"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"p-6 bg-gray-50 rounded-lg border border-gray-200 animate-fade-in-up",style:{animationDelay:"100ms"},children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Platform Stats"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total Users"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:n?.userCount?.toLocaleString()||"0"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total Orders"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:n?.orderCount?.toLocaleString()||"0"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Active Sellers"}),e.jsx("span",{className:"text-sm font-semibold text-green-600",children:n?.sellerCount?.toLocaleString()||"0"})]})]})]}),e.jsxs("div",{className:"p-6 bg-gray-50 rounded-lg border border-gray-200 animate-fade-in-up",style:{animationDelay:"200ms"},children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Alerts Summary"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Open Disputes"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:n?.openDisputes||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Pending Applications"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:n?.pendingApplications||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Recent Orders (24h)"}),e.jsx("span",{className:"text-sm font-semibold text-green-600",children:n?.recentOrdersCount||0})]})]})]})]})})]})]})]})]}),e.jsx(U,{})]})}export{q as default};
//# sourceMappingURL=page-B0HWGMge.js.map

{"version":3,"file":"page-auGWq1G1.js","sources":["../../src/pages/account/notifications/page.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport Header from '../../../components/feature/Header';\nimport Footer from '../../../components/feature/Footer';\nimport SkeletonLoader from '../../../components/base/SkeletonLoader';\nimport { notificationsService } from '../../../lib/services';\nimport { useAuth } from '../../../lib/auth';\n\ntype NotificationType = 'all' | 'orders' | 'promotions' | 'system';\n\ninterface Notification {\n  id: string;\n  type: NotificationType;\n  title: string;\n  message: string;\n  time: string;\n  read: boolean;\n  icon: string;\n  iconColor: string;\n  orderId?: string;\n}\n\nexport default function NotificationsPage() {\n  const { user } = useAuth();\n  const [activeFilter, setActiveFilter] = useState<NotificationType>('all');\n  const [notifications, setNotifications] = useState<Notification[]>([]);\n  const [loading, setLoading] = useState(true);\n\n  // Fetch notifications from API\n  useEffect(() => {\n    async function fetchNotifications() {\n      if (!user?.id) {\n        setLoading(false);\n        return;\n      }\n\n      setLoading(true);\n      try {\n        const apiNotifications = await notificationsService.list();\n\n        // Transform API response\n        setNotifications(apiNotifications.map((n: any) => ({\n          id: n.id,\n          type: getCategoryForType(n.type),\n          title: n.title || 'Notification',\n          message: n.body || n.message || '',\n          time: formatTimeAgo(n.createdAt),\n          read: n.readAt !== null,\n          icon: getIconForType(n.type),\n          iconColor: getColorForType(n.type),\n          orderId: n.data?.orderId,\n        })));\n      } catch (err) {\n        console.error('Failed to fetch notifications:', err);\n      } finally {\n        setLoading(false);\n      }\n    }\n    fetchNotifications();\n  }, [user?.id]);\n\n  function formatTimeAgo(date: string): string {\n    const seconds = Math.floor((Date.now() - new Date(date).getTime()) / 1000);\n    if (seconds < 60) return 'Just now';\n    if (seconds < 3600) return `${Math.floor(seconds / 60)} minutes ago`;\n    if (seconds < 86400) return `${Math.floor(seconds / 3600)} hours ago`;\n    return `${Math.floor(seconds / 86400)} days ago`;\n  }\n\n  function getCategoryForType(type: string): NotificationType {\n    const normalized = type?.toLowerCase() || '';\n    if (normalized.startsWith('order_') || normalized === 'new_review') {\n      return 'orders';\n    }\n    if (normalized.startsWith('payout') || normalized.startsWith('dispute')) {\n      return 'system';\n    }\n    if (normalized.includes('promotion')) {\n      return 'promotions';\n    }\n    return 'system';\n  }\n\n  function getIconForType(type: string): string {\n    const normalized = type?.toLowerCase() || '';\n    if (normalized.startsWith('order_')) return 'ri-truck-line';\n    if (normalized.startsWith('payout')) return 'ri-money-dollar-circle-line';\n    if (normalized.startsWith('dispute')) return 'ri-error-warning-line';\n    if (normalized === 'new_review') return 'ri-star-line';\n    if (normalized.includes('promotion')) return 'ri-fire-line';\n    return 'ri-notification-line';\n  }\n\n  function getColorForType(type: string): string {\n    const normalized = type?.toLowerCase() || '';\n    if (normalized.startsWith('order_')) return 'text-emerald-600';\n    if (normalized.startsWith('payout')) return 'text-green-600';\n    if (normalized.startsWith('dispute')) return 'text-red-600';\n    if (normalized === 'new_review') return 'text-amber-600';\n    if (normalized.includes('promotion')) return 'text-orange-600';\n    return 'text-blue-600';\n  }\n\n  const filterCounts = {\n    all: notifications.length,\n    orders: notifications.filter(n => n.type === 'orders').length,\n    promotions: notifications.filter(n => n.type === 'promotions').length,\n    system: notifications.filter(n => n.type === 'system').length\n  };\n\n  const filteredNotifications = activeFilter === 'all'\n    ? notifications\n    : notifications.filter(n => n.type === activeFilter);\n\n  const markAsRead = async (id: string) => {\n    try {\n      await notificationsService.markRead(id);\n      setNotifications(notifications.map(n =>\n        n.id === id ? { ...n, read: true } : n\n      ));\n    } catch (err) {\n      console.error('Failed to mark as read:', err);\n    }\n  };\n\n  const markAllAsRead = async () => {\n    try {\n      await notificationsService.markAllRead();\n      setNotifications(notifications.map(n => ({ ...n, read: true })));\n    } catch (err) {\n      console.error('Failed to mark all as read:', err);\n    }\n  };\n\n  const deleteNotification = async (id: string) => {\n    try {\n      await notificationsService.delete(id);\n      setNotifications(notifications.filter(n => n.id !== id));\n    } catch (err) {\n      console.error('Failed to delete notification:', err);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex flex-col\">\n        <Header />\n        <div className=\"flex-1 max-w-4xl mx-auto w-full px-4 py-8\">\n          <h1 className=\"text-3xl font-bold text-gray-900 mb-6\">Notifications</h1>\n          <div className=\"space-y-3\">\n            {[...Array(5)].map((_, i) => <SkeletonLoader key={i} type=\"text\" />)}\n          </div>\n        </div>\n        <Footer />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 flex flex-col\">\n      <Header />\n\n      <div className=\"flex-1 max-w-4xl mx-auto w-full px-4 py-8\">\n        {/* Header */}\n        <div className=\"mb-6\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <h1 className=\"text-3xl font-bold text-gray-900\">Notifications</h1>\n            <button\n              onClick={markAllAsRead}\n              className=\"text-sm text-emerald-600 hover:text-emerald-700 font-medium whitespace-nowrap\"\n            >\n              Mark all as read\n            </button>\n          </div>\n          <p className=\"text-gray-600\">Stay updated with your orders and promotions</p>\n        </div>\n\n        {/* Filters */}\n        <div className=\"bg-white rounded-xl shadow-sm p-4 mb-6\">\n          <div className=\"flex flex-wrap gap-3\">\n            {(['all', 'orders', 'promotions', 'system'] as NotificationType[]).map(filter => (\n              <button\n                key={filter}\n                onClick={() => setActiveFilter(filter)}\n                className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors whitespace-nowrap ${activeFilter === filter\n                  ? 'bg-emerald-600 text-white'\n                  : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                  }`}\n              >\n                {filter.charAt(0).toUpperCase() + filter.slice(1)} ({filterCounts[filter]})\n              </button>\n            ))}\n          </div>\n        </div>\n\n        {/* Notifications List */}\n        <div className=\"space-y-3\">\n          {filteredNotifications.length === 0 ? (\n            <div className=\"bg-white rounded-xl shadow-sm p-12 text-center\">\n              <i className=\"ri-notification-off-line text-6xl text-gray-300 mb-4\"></i>\n              <p className=\"text-gray-500\">No notifications in this category.</p>\n            </div>\n          ) : (\n            filteredNotifications.map((notification) => (\n              <div\n                key={notification.id}\n                className={`bg-white rounded-xl shadow-sm p-4 transition-all hover:shadow-md ${!notification.read ? 'border-l-4 border-emerald-600' : ''\n                  }`}\n              >\n                <div className=\"flex items-start gap-4\">\n                  <div className=\"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center flex-shrink-0\">\n                    <i className={`${notification.icon} text-xl ${notification.iconColor}`}></i>\n                  </div>\n\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-start justify-between gap-4 mb-1\">\n                      <h3 className=\"font-semibold text-gray-900\">{notification.title}</h3>\n                      <span className=\"text-xs text-gray-500 whitespace-nowrap\">{notification.time}</span>\n                    </div>\n                    <p className=\"text-sm text-gray-600 mb-3\">{notification.message}</p>\n\n                    <div className=\"flex items-center gap-4\">\n                      {notification.orderId && (\n                        <Link\n                          to={`/orders/${notification.orderId}/tracking`}\n                          className=\"text-xs text-emerald-600 hover:text-emerald-700 font-medium whitespace-nowrap\"\n                        >\n                          View order\n                        </Link>\n                      )}\n                      {!notification.read && (\n                        <button\n                          onClick={() => markAsRead(notification.id)}\n                          className=\"text-xs text-emerald-600 hover:text-emerald-700 font-medium whitespace-nowrap\"\n                        >\n                          Mark as read\n                        </button>\n                      )}\n                      <button\n                        onClick={() => deleteNotification(notification.id)}\n                        className=\"text-xs text-red-600 hover:text-red-700 font-medium whitespace-nowrap\"\n                      >\n                        Delete\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))\n          )}\n        </div>\n\n        {/* Settings Link */}\n        <div className=\"mt-8 text-center\">\n          <Link\n            to=\"/account/settings/notifications\"\n            className=\"inline-flex items-center gap-2 text-emerald-600 hover:text-emerald-700 font-medium\"\n          >\n            <i className=\"ri-settings-3-line\"></i>\n            Notification Settings\n          </Link>\n        </div>\n      </div>\n\n      <Footer />\n    </div>\n  );\n}\n"],"names":["NotificationsPage","user","useAuth","activeFilter","setActiveFilter","useState","notifications","setNotifications","loading","setLoading","useEffect","fetchNotifications","apiNotifications","notificationsService","n","getCategoryForType","formatTimeAgo","getIconForType","getColorForType","err","date","seconds","type","normalized","filterCounts","filteredNotifications","markAsRead","id","markAllAsRead","deleteNotification","jsxs","jsx","Header","_","i","SkeletonLoader","Footer","filter","notification","Link"],"mappings":"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"}
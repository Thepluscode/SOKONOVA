import{a as h,r as u,j as e,d as $,u as C,L as N,e as W}from"./index-BuEVh5sI.js";import{H as S,F as k}from"./Footer-BUHV-7DN.js";import{S as A}from"./SkeletonLoader-xTJJaupH.js";import{p as T}from"./productsService-CjVt01BF.js";const I="wishlist_items";function w(){try{return JSON.parse(localStorage.getItem(I)||"[]")}catch{return[]}}function v(s){localStorage.setItem(I,JSON.stringify(s))}const m={getItems:async s=>h.get(`/wishlist/user/${s}`),addItem:async(s,l)=>h.post("/wishlist",{userId:s,productId:l}),removeItem:async s=>h.delete(`/wishlist/${s}`),removeByProduct:async(s,l)=>h.delete(`/wishlist/user/${s}/product/${l}`),clearAll:async s=>h.delete(`/wishlist/user/${s}/clear`),isInWishlist:async(s,l)=>{try{return(await h.get(`/wishlist/user/${s}/check/${l}`)).inWishlist}catch{return!1}},local:{getItems:()=>w(),addItem:s=>{const l=w();l.includes(s)||(l.push(s),v(l))},removeItem:s=>{const l=w().filter(i=>i!==s);v(l)},clearAll:()=>{v([])},isInWishlist:s=>w().includes(s)}};function F({wishlistId:s,wishlistName:l,itemCount:i,onClose:y}){const[g,p]=u.useState(!1),d=`${window.location.origin}/wishlist/shared/${s}`,j=()=>{navigator.clipboard.writeText(d),p(!0),setTimeout(()=>p(!1),2e3)},c=f=>{const b=`Check out my wishlist "${l}" with ${i} items on SOKONOVA!`,x=encodeURIComponent(b),n=encodeURIComponent(d),t={facebook:`https://www.facebook.com/sharer/sharer.php?u=${n}`,twitter:`https://twitter.com/intent/tweet?text=${x}&url=${n}`,whatsapp:`https://wa.me/?text=${x}%20${n}`,telegram:`https://t.me/share/url?url=${n}&text=${x}`,email:`mailto:?subject=${encodeURIComponent(l)}&body=${x}%20${n}`};window.open(t[f],"_blank","width=600,height=400")};return e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl w-full max-w-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Share Wishlist"}),e.jsx("button",{onClick:y,className:"w-8 h-8 flex items-center justify-center text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full transition-colors whitespace-nowrap",children:e.jsx("i",{className:"ri-close-line text-xl"})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-gray-600 mb-2",children:['Share "',l,'"']}),e.jsxs("p",{className:"text-sm text-gray-500",children:[i," items in this wishlist"]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Share Link"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:d,readOnly:!0,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 text-sm"}),e.jsx("button",{onClick:j,className:"px-4 py-2 bg-teal-500 text-white rounded-lg hover:bg-teal-600 transition-colors whitespace-nowrap",children:g?e.jsx("i",{className:"ri-check-line"}):e.jsx("i",{className:"ri-file-copy-line"})})]}),g&&e.jsx("p",{className:"text-sm text-teal-600 mt-2",children:"Link copied to clipboard!"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Share on Social Media"}),e.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[e.jsxs("button",{onClick:()=>c("facebook"),className:"flex flex-col items-center gap-2 p-3 rounded-lg hover:bg-gray-50 transition-colors whitespace-nowrap",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"ri-facebook-fill text-xl text-white"})}),e.jsx("span",{className:"text-xs text-gray-600",children:"Facebook"})]}),e.jsxs("button",{onClick:()=>c("twitter"),className:"flex flex-col items-center gap-2 p-3 rounded-lg hover:bg-gray-50 transition-colors whitespace-nowrap",children:[e.jsx("div",{className:"w-12 h-12 bg-sky-500 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"ri-twitter-fill text-xl text-white"})}),e.jsx("span",{className:"text-xs text-gray-600",children:"Twitter"})]}),e.jsxs("button",{onClick:()=>c("whatsapp"),className:"flex flex-col items-center gap-2 p-3 rounded-lg hover:bg-gray-50 transition-colors whitespace-nowrap",children:[e.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"ri-whatsapp-fill text-xl text-white"})}),e.jsx("span",{className:"text-xs text-gray-600",children:"WhatsApp"})]}),e.jsxs("button",{onClick:()=>c("telegram"),className:"flex flex-col items-center gap-2 p-3 rounded-lg hover:bg-gray-50 transition-colors whitespace-nowrap",children:[e.jsx("div",{className:"w-12 h-12 bg-sky-400 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"ri-telegram-fill text-xl text-white"})}),e.jsx("span",{className:"text-xs text-gray-600",children:"Telegram"})]}),e.jsxs("button",{onClick:()=>c("email"),className:"flex flex-col items-center gap-2 p-3 rounded-lg hover:bg-gray-50 transition-colors whitespace-nowrap",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-600 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"ri-mail-fill text-xl text-white"})}),e.jsx("span",{className:"text-xs text-gray-600",children:"Email"})]})]})]})]})})}function U(){const{user:s}=$(),[l,i]=u.useState([]),[y,g]=u.useState(!0),[p,d]=u.useState(null),[j,c]=u.useState(!1),{showToast:f}=C();u.useEffect(()=>{async function t(){g(!0);try{let a=[];if(s?.id?a=(await m.getItems(s.id)).map(r=>r.productId):a=m.local.getItems(),a.length>0){const o=await T.getByIds(a);i(o.map(r=>({id:r.id,productId:r.id,name:r.title,price:Number(r.price),originalPrice:Number(r.price)*1.2,image:r.imageUrl||`https://readdy.ai/api/search-image?query=product&width=400&height=400&seq=${r.id}`,rating:4.5,reviews:128,inStock:!0})))}else i([])}catch(a){console.error("Failed to fetch wishlist:",a)}finally{g(!1)}}t()},[s?.id]);const b=async t=>{try{s?.id?await m.removeByProduct(s.id,t):m.local.removeItem(t),i(a=>a.filter(o=>o.productId!==t))}catch(a){console.error("Failed to remove from wishlist:",a)}},x=async()=>{if(confirm("Are you sure you want to clear your entire wishlist?"))try{s?.id?await m.clearAll(s.id):m.local.clearAll(),i([])}catch(t){console.error("Failed to clear wishlist:",t)}},n=async t=>{d(t);try{if(s?.id)await W.addItem(s.id,t,1);else{const a=JSON.parse(localStorage.getItem("cart")||"[]"),o=a.find(r=>r.productId===t);o?o.quantity+=1:a.push({productId:t,quantity:1}),localStorage.setItem("cart",JSON.stringify(a))}f({message:"Added to cart.",type:"success"})}catch(a){console.error("Failed to add to cart:",a),f({message:"Could not add to cart. Please try again.",type:"error"})}finally{d(null)}};return y?e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx(S,{}),e.jsx("main",{className:"flex-grow container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"My Wishlist"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((t,a)=>e.jsx(A,{type:"card"},a))})]})}),e.jsx(k,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx(S,{}),e.jsx("main",{className:"flex-grow container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"My Wishlist"}),e.jsxs("p",{className:"text-gray-600",children:[l.length," items saved"]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>c(!0),className:"text-teal-600 hover:text-teal-700 font-semibold transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-share-line mr-2"}),"Share Wishlist"]}),l.length>0&&e.jsxs("button",{onClick:x,className:"text-red-600 hover:text-red-700 font-semibold transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-delete-bin-line mr-2"}),"Clear All"]})]})]}),l.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-32 h-32 mx-auto mb-6 bg-gradient-to-br from-teal-100 to-emerald-100 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"ri-heart-line text-6xl text-teal-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Your wishlist is empty"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Save items you love for later!"}),e.jsx(N,{to:"/products",className:"inline-block bg-gradient-to-r from-teal-600 to-emerald-600 text-white px-8 py-3 rounded-xl font-semibold hover:from-teal-700 hover:to-emerald-700 transition-all",children:"Start Shopping"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:l.map(t=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden hover-lift transition-all duration-500 group",children:[e.jsxs("div",{className:"relative",children:[e.jsx(N,{to:`/products/${t.productId}`,children:e.jsx("div",{className:"w-full h-64 bg-gray-100 overflow-hidden",children:e.jsx("img",{src:t.image,alt:t.name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"})})}),e.jsx("button",{onClick:()=>b(t.productId),className:"absolute top-4 right-4 w-10 h-10 bg-white rounded-full shadow-lg flex items-center justify-center text-red-500 hover:bg-red-50 transition-all opacity-0 group-hover:opacity-100",children:e.jsx("i",{className:"ri-close-line text-xl"})}),!t.inStock&&e.jsx("div",{className:"absolute top-4 left-4 bg-red-500 text-white px-3 py-1 rounded-full text-xs font-semibold",children:"Out of Stock"}),t.originalPrice>t.price&&e.jsxs("div",{className:"absolute bottom-4 left-4 bg-gradient-to-r from-teal-600 to-emerald-600 text-white px-3 py-1 rounded-full text-xs font-semibold",children:["Save ",Math.round((t.originalPrice-t.price)/t.originalPrice*100),"%"]})]}),e.jsxs("div",{className:"p-6",children:[e.jsx(N,{to:`/products/${t.productId}`,className:"block mb-2 hover:text-teal-600 transition-colors",children:e.jsx("h3",{className:"text-lg font-bold text-gray-900 line-clamp-2",children:t.name})}),e.jsxs("div",{className:"flex items-center mb-3",children:[[...Array(5)].map((a,o)=>e.jsx("i",{className:`text-sm ${o<Math.floor(t.rating)?"ri-star-fill text-yellow-400":"ri-star-line text-gray-300"}`},o)),e.jsxs("span",{className:"ml-2 text-xs text-gray-600",children:["(",t.reviews,")"]})]}),e.jsxs("div",{className:"flex items-baseline space-x-2 mb-4",children:[e.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:["$",t.price.toFixed(2)]}),t.originalPrice>t.price&&e.jsxs("span",{className:"text-sm text-gray-500 line-through",children:["$",t.originalPrice.toFixed(2)]})]}),e.jsx("button",{onClick:()=>n(t.productId),disabled:!t.inStock||p===t.productId,className:`w-full py-3 rounded-xl font-semibold transition-all ${t.inStock?"bg-gradient-to-r from-teal-600 to-emerald-600 text-white hover:from-teal-700 hover:to-emerald-700":"bg-gray-200 text-gray-500 cursor-not-allowed"}`,children:p===t.productId?e.jsx("i",{className:"ri-loader-4-line animate-spin"}):t.inStock?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-shopping-cart-line mr-2"}),"Add to Cart"]}):"Out of Stock"})]})]},t.id))})]})}),j&&e.jsx(F,{wishlistId:s?.id||"guest",wishlistName:"My Wishlist",itemCount:l.length,onClose:()=>c(!1)}),e.jsx(k,{})]})}export{U as default};
//# sourceMappingURL=page-BQBq_Drl.js.map

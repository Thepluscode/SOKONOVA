import{d as q,g as B,r as t,j as e,L as V}from"./index-ZpOvIOBK.js";import{H as S,F as D}from"./Footer-Cn1l-7sc.js";import{B as H}from"./Button-BDm5bFDW.js";import{S as C}from"./SkeletonLoader-DhyVqy1u.js";import{p as K}from"./productsService-Ck9jMMMB.js";import{a as L}from"./analyticsService-Bw8LQzrT.js";function Z(){const{user:c}=q();B("SELLER");const[g,$]=t.useState("30d"),[h,R]=t.useState("revenue"),[o,T]=t.useState(!1),[A,I]=t.useState(new Date),[M,N]=t.useState(!0),[k,w]=t.useState(null),[n,U]=t.useState({revenue:{current:0,previous:0,change:0,chartData:[]},orders:{current:0,previous:0,change:0,chartData:[]},visitors:{current:0,previous:0,change:0,chartData:[]},conversion:{current:0,previous:0,change:0,chartData:[]}}),[y,E]=t.useState([]),[v,P]=t.useState({topCountries:[],ageGroups:[]});t.useEffect(()=>{async function r(){if(c?.id){N(!0),w(null);try{const[a,i,l]=await Promise.all([L.getSellerProfitability(c.id).catch(()=>null),L.getBuyerInsights(c.id).catch(()=>null),K.list({sellerId:c.id}).catch(()=>[])]),x=a?.totalRevenue||0,u=a?.totalOrders||0,m=a?.totalVisitors||1e3,j=m>0?u/m*100:0,p=(s,b=7)=>Array.from({length:b},(J,O)=>{const f=new Date;f.setDate(f.getDate()-(b-1-O));const G=(Math.random()-.5)*.4;return{date:f.toISOString().split("T")[0],value:Math.round(s/b*(1+G))}});U({revenue:{current:x,previous:x*.85,change:17.6,chartData:p(x)},orders:{current:u,previous:Math.floor(u*.88),change:13.6,chartData:p(u)},visitors:{current:m,previous:Math.floor(m*.82),change:22,chartData:p(m)},conversion:{current:j,previous:j*.95,change:5.3,chartData:p(j*100,7).map(s=>({...s,value:s.value/10}))}}),E(l.slice(0,5).map(s=>({id:s.id,name:s.title,revenue:Number(s.price)*(s.soldCount||0),orders:s.soldCount||0,views:s.viewCount||Math.floor(Math.random()*500)+100,conversion:((s.soldCount||0)/(s.viewCount||1)*100).toFixed(1),image:s.imageUrl||`https://readdy.ai/api/search-image?query=product&width=300&height=300&seq=${s.id}&orientation=squarish`}))),P({topCountries:i?.topCountries||[{country:"United States",orders:45,revenue:5400},{country:"United Kingdom",orders:32,revenue:3800},{country:"Nigeria",orders:28,revenue:3200},{country:"Ghana",orders:22,revenue:2600},{country:"Kenya",orders:18,revenue:2100}],ageGroups:i?.ageGroups||[{group:"25-34",percentage:35},{group:"35-44",percentage:28},{group:"45-54",percentage:22},{group:"18-24",percentage:10},{group:"55+",percentage:5}]})}catch(a){console.error("Failed to fetch analytics:",a),w("Could not load analytics. Please try again.")}finally{N(!1)}}}r()},[c?.id,g]),t.useEffect(()=>{if(o){const r=setInterval(()=>{I(new Date)},5e3);return()=>clearInterval(r)}},[o]);const d=n[h],F=()=>{const r={timeRange:g,metrics:n,topProducts:y,customerInsights:v,exportedAt:new Date().toISOString()},a=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),i=URL.createObjectURL(a),l=document.createElement("a");l.href=i,l.download=`analytics-report-${g}-${Date.now()}.json`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(i)};return M?e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx(S,{}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[1,2,3,4].map(r=>e.jsx(C,{type:"card"},r))}),e.jsx(C,{type:"card"})]}),e.jsx(D,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors",children:[e.jsx(S,{}),e.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 transition-colors",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(V,{to:"/seller-dashboard",className:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",children:e.jsx("i",{className:"ri-arrow-left-line text-xl"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Analytics & Performance"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Track your store performance and customer insights"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:()=>T(!o),className:`flex items-center space-x-2 px-4 py-2 rounded-lg border transition-all cursor-pointer ${o?"bg-emerald-50 dark:bg-emerald-900/20 border-emerald-500 text-emerald-600 dark:text-emerald-400":"border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${o?"bg-emerald-500 animate-pulse":"bg-gray-400"}`}),e.jsx("span",{className:"text-sm font-medium",children:"Real-time"})]}),e.jsxs("select",{value:g,onChange:r=>$(r.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 dark:bg-gray-700 dark:text-white transition-colors",children:[e.jsx("option",{value:"7d",children:"Last 7 days"}),e.jsx("option",{value:"30d",children:"Last 30 days"}),e.jsx("option",{value:"90d",children:"Last 90 days"}),e.jsx("option",{value:"1y",children:"Last year"})]}),e.jsxs(H,{variant:"outline",onClick:F,children:[e.jsx("i",{className:"ri-download-line mr-2"}),"Export Report"]})]})]}),o&&e.jsxs("div",{className:"mt-4 flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("i",{className:"ri-time-line"}),e.jsxs("span",{children:["Last updated: ",A.toLocaleTimeString()]})]})]})}),k&&e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-8",children:e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-800",children:k})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[{key:"revenue",label:"Total Revenue",value:`$${n.revenue.current.toLocaleString()}`,icon:"ri-money-dollar-circle-line",color:"emerald"},{key:"orders",label:"Total Orders",value:n.orders.current.toString(),icon:"ri-shopping-bag-line",color:"blue"},{key:"visitors",label:"Store Visitors",value:n.visitors.current.toLocaleString(),icon:"ri-eye-line",color:"purple"},{key:"conversion",label:"Conversion Rate",value:`${n.conversion.current.toFixed(1)}%`,icon:"ri-line-chart-line",color:"orange"}].map(r=>e.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm cursor-pointer border-2 transition-all hover:shadow-md ${h===r.key?"border-emerald-500 scale-105":"border-transparent"}`,onClick:()=>R(r.key),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:r.label}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:r.value})]}),e.jsx("div",{className:`w-12 h-12 bg-${r.color}-100 dark:bg-${r.color}-900/30 text-${r.color}-600 dark:text-${r.color}-400 rounded-lg flex items-center justify-center`,children:e.jsx("i",{className:`${r.icon} text-xl`})})]}),e.jsxs("div",{className:"mt-4 flex items-center text-sm",children:[e.jsxs("span",{className:`font-medium ${n[r.key].change>=0?"text-green-600":"text-red-600"}`,children:[n[r.key].change>=0?"+":"",n[r.key].change.toFixed(1),"%"]}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400 ml-2",children:"vs previous period"})]})]},r.key))}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 mb-8 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[h.charAt(0).toUpperCase()+h.slice(1)," Trend"]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("span",{className:`font-medium ${d.change>=0?"text-green-600":"text-red-600"}`,children:[d.change>=0?"+":"",d.change.toFixed(1),"%"]}),e.jsx("span",{children:"change"})]})]}),e.jsx("div",{className:"h-64 flex items-end space-x-2",children:d.chartData.map((r,a)=>{const i=Math.max(...d.chartData.map(x=>x.value)),l=i>0?r.value/i*200:20;return e.jsxs("div",{className:"flex-1 flex flex-col items-center group",children:[e.jsx("div",{className:"relative w-full",children:e.jsx("div",{className:"w-full bg-gradient-to-t from-emerald-500 to-emerald-400 rounded-t-lg transition-all duration-300 group-hover:from-emerald-600 group-hover:to-emerald-500 cursor-pointer",style:{height:`${Math.max(l,10)}px`},children:e.jsx("div",{className:"absolute -top-8 left-1/2 -translate-x-1/2 bg-gray-900 dark:bg-gray-700 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",children:typeof r.value=="number"?r.value.toLocaleString():r.value})})}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:new Date(r.date).getDate()})]},a)})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm transition-colors",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Top Performing Products"})}),e.jsx("div",{className:"p-6",children:y.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No products yet."}):e.jsx("div",{className:"space-y-4",children:y.map((r,a)=>e.jsxs("div",{className:"flex items-center space-x-4 p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[e.jsx("span",{className:"w-6 h-6 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded-full flex items-center justify-center text-sm font-medium",children:a+1}),e.jsx("img",{src:r.image,alt:r.name,className:"w-12 h-12 rounded-lg object-cover"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white truncate",children:r.name}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("span",{children:["$",r.revenue.toLocaleString()]}),e.jsxs("span",{children:[r.orders," orders"]}),e.jsxs("span",{children:[r.conversion,"% conv."]})]})]})]},r.id))})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm transition-colors",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Customer Insights"})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-3",children:"Top Countries"}),e.jsx("div",{className:"space-y-2",children:v.topCountries.map((r,a)=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:r.country}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:r.orders}),e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["$",r.revenue]})]})]},a))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-3",children:"Age Groups"}),e.jsx("div",{className:"space-y-2",children:v.ageGroups.map((r,a)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:r.group}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-20 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-2 bg-emerald-500 rounded-full transition-all duration-500",style:{width:`${r.percentage}%`}})}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-white w-10 text-right",children:[r.percentage,"%"]})]})]},a))})]})]})]})]})]}),e.jsx(D,{})]})}export{Z as default};
//# sourceMappingURL=page-n4o0PUXk.js.map
